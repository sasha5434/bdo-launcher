(function(){var $=window.jQuery,$win=$(window),$doc=$(document);var svgNS="http://www.w3.org/2000/svg",svgSupported="SVGAngle"in window&&function(){var supported,el=document.createElement("div");el.innerHTML="<svg/>";supported=(el.firstChild&&el.firstChild.namespaceURI)==svgNS;el.innerHTML="";return supported}();var transitionSupported=function(){var style=document.createElement("div").style;return"transition"in style||"WebkitTransition"in style||"MozTransition"in style||"msTransition"in style||"OTransition"in style}();var touchSupported="ontouchstart"in window,mousedownEvent="mousedown"+(touchSupported?" touchstart":""),mousemoveEvent="mousemove.clockpicker"+(touchSupported?" touchmove.clockpicker":""),mouseupEvent="mouseup.clockpicker"+(touchSupported?" touchend.clockpicker":"");var vibrate=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function createSvgElement(name){return document.createElementNS(svgNS,name)}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}function leadingZero(num){return(num<10?"0":"")+num}var idCounter=0;function uniqueId(prefix){var id=++idCounter+"";return prefix?prefix+id:id}var dialRadius=135,outerRadius=110,innerRadius=80,tickRadius=20,diameter=dialRadius*2,duration=transitionSupported?350:1;var tpl=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>"].join("");function ClockPicker(element,options){var popover=$(tpl),plate=popover.find(".clockpicker-plate"),holder=popover.find(".picker__holder"),hoursView=popover.find(".clockpicker-hours"),minutesView=popover.find(".clockpicker-minutes"),amPmBlock=popover.find(".clockpicker-am-pm-block"),isInput=element.prop("tagName")==="INPUT",input=isInput?element:element.find("input"),isHTML5=input.prop("type")==="time",label=$("label[for="+input.attr("id")+"]"),self=this,timer;this.id=uniqueId("cp");this.element=element;this.holder=holder;this.options=options;this.isAppended=false;this.isShown=false;this.currentView="hours";this.isInput=isInput;this.input=input;this.label=label;this.popover=popover;this.plate=plate;this.hoursView=hoursView;this.minutesView=minutesView;this.amPmBlock=amPmBlock;this.spanHours=popover.find(".clockpicker-span-hours");this.spanMinutes=popover.find(".clockpicker-span-minutes");this.spanAmPm=popover.find(".clockpicker-span-am-pm");this.footer=popover.find(".picker__footer");this.amOrPm="";this.isTwelvehour=options.twelvehour;this.minTime=0;this.maxTime=0;this.minMinutes=0;this.maxMinutes=59;this.minHours=0;this.maxHours=23;this.isInvalidTimeScope=false;const parseTimeOptions=scope=>{const time=scope+"Time";this[time]=options[scope].split(":");if(this[time][1].length===4){const period=this[time][1].replace(/\d+/g,"").toUpperCase();this[time][1]=this[time][1].replace(/\D+/g,"");if(period==="PM")this[time][0]=parseInt(this[time][0])+12}if(this[time].length!==2)this[time]=null;else{for(let i=0;i<this[time].length;i++){this[time][i]=+this[time][i]}}};if(options.min){parseTimeOptions("min");this.minMinutes=this.minTime[1];this.minHours=this.minTime[0]}if(options.max){parseTimeOptions("max");if(this.minHours>this.maxHours||this.minHours===this.maxHours&&this.minMinutes>=this.maxMinutes){this.maxTime=0}else{this.maxMinutes=this.maxTime[1];this.maxHours=this.maxTime[0]}}if(options.twelvehour){var amPmButtonsTemplate=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-am-button">',"AM","</button>",'<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-pm-button">',"PM","</button>","</div>"].join("");var amPmButtons=$(amPmButtonsTemplate);const togglePeriod=period=>{let previsiousPeriod="pm";if(period==="PM")previsiousPeriod="am";self.amOrPm=period;self.amPmBlock.children(`.${previsiousPeriod}-button`).removeClass("active");self.amPmBlock.children(`.${period.toLowerCase()}-button`).addClass("active");self.spanAmPm.empty().append(period);this.disableOutOfRangeElements()};if(!options.ampmclickable){$('<button type="button" class="btn-floating btn-flat clockpicker-button am-button" tabindex="1">'+"AM"+"</button>").on("click",function(){togglePeriod("AM")}).appendTo(this.amPmBlock);$('<button type="button" class="btn-floating btn-flat clockpicker-button pm-button" tabindex="2">'+"PM"+"</button>").on("click",function(){togglePeriod("PM")}).appendTo(this.amPmBlock)}else{this.spanAmPm.empty();$('<div id="click-am">AM</div>').on("click",function(){self.spanAmPm.children("#click-am").addClass("text-primary");self.spanAmPm.children("#click-pm").removeClass("text-primary");self.amOrPm="AM"}).appendTo(this.spanAmPm);$('<div id="click-pm">PM</div>').on("click",function(){self.spanAmPm.children("#click-pm").addClass("text-primary");self.spanAmPm.children("#click-am").removeClass("text-primary");self.amOrPm="PM"}).appendTo(this.spanAmPm)}}if(options.darktheme)popover.addClass("darktheme");$('<button type="button" class="btn btn-flat clockpicker-button done-button" tabindex="'+(options.twelvehour?"3":"1")+'">'+options.donetext+"</button>").click($.proxy(this.done,this)).appendTo(this.footer);$('<button type="button" class="btn btn-flat clockpicker-button clear-button" tabindex="'+(options.twelvehour?"4":"2")+'">'+options.cleartext+"</button>").click($.proxy(this.clearInput,this)).appendTo(this.footer);this.spanHours.click($.proxy(this.toggleView,this,"hours"));this.spanMinutes.click($.proxy(this.toggleView,this,"minutes"));input.on("click.clockpicker",debounce($.proxy(this.show,this),100));var tickTpl=$('<div class="clockpicker-tick"></div>'),i,tick,radian,radius;if(options.twelvehour){for(i=0;i<12;i+=options.hourstep){tick=tickTpl.clone();radian=i/6*Math.PI;radius=outerRadius;tick.css("font-size","140%");tick.css({left:dialRadius+Math.sin(radian)*radius-tickRadius,top:dialRadius-Math.cos(radian)*radius-tickRadius});tick.html(i===0?12:i);hoursView.append(tick);tick.on(mousedownEvent,mousedown);this.disableOutOfRangeElements()}}else{for(i=0;i<24;i+=options.hourstep){tick=tickTpl.clone();radian=i/6*Math.PI;var inner=i>0&&i<13;radius=inner?innerRadius:outerRadius;tick.css({left:dialRadius+Math.sin(radian)*radius-tickRadius,top:dialRadius-Math.cos(radian)*radius-tickRadius});if(inner){tick.css("font-size","120%")}tick.html(i===0?"00":i);hoursView.append(tick);tick.on(mousedownEvent,mousedown);this.disableOutOfRangeElements()}}var incrementValue=Math.max(options.minutestep,5);for(i=0;i<60;i+=incrementValue){for(i=0;i<60;i+=5){tick=tickTpl.clone();radian=i/30*Math.PI;tick.css({left:dialRadius+Math.sin(radian)*outerRadius-tickRadius,top:dialRadius-Math.cos(radian)*outerRadius-tickRadius});tick.css("font-size","140%");tick.html(leadingZero(i));minutesView.append(tick);tick.on(mousedownEvent,mousedown)}}plate.on(mousedownEvent,function(e){if($(e.target).closest(".clockpicker-tick").length===0)mousedown(e,true)});function mousedown(e,space){var offset=plate.offset(),isTouch=/^touch/.test(e.type),x0=offset.left+dialRadius,y0=offset.top+dialRadius,dx=(isTouch?e.originalEvent.touches[0]:e).pageX-x0,dy=(isTouch?e.originalEvent.touches[0]:e).pageY-y0,z=Math.sqrt(dx*dx+dy*dy),moved=false;if(space&&(z<outerRadius-tickRadius||z>outerRadius+tickRadius))return;e.preventDefault();var movingTimer=setTimeout(function(){self.popover.addClass("clockpicker-moving")},200);if(svgSupported)plate.append(self.canvas);self.setHand(dx,dy,!space,true);$doc.off(mousemoveEvent).on(mousemoveEvent,function(e){e.preventDefault();var isTouch=/^touch/.test(e.type),x=(isTouch?e.originalEvent.touches[0]:e).pageX-x0,y=(isTouch?e.originalEvent.touches[0]:e).pageY-y0;if(!moved&&x===dx&&y===dy)return;moved=true;self.setHand(x,y,false,true)});$doc.off(mouseupEvent).on(mouseupEvent,function(e){$doc.off(mouseupEvent);e.preventDefault();var isTouch=/^touch/.test(e.type),x=(isTouch?e.originalEvent.changedTouches[0]:e).pageX-x0,y=(isTouch?e.originalEvent.changedTouches[0]:e).pageY-y0;if((space||moved)&&x===dx&&y===dy)self.setHand(x,y);let{hours,minutes,amOrPm,maxHours,minHours,maxMinutes,minMinutes}=self;if(amOrPm==="PM"){if(minHours<12)minHours=0;if(minHours>12)minHours-=12;if(maxHours>12)maxHours-=12}if(self.isInvalidTimeScope){self.isInvalidTimeScope=false;e.stopPropagation()}else if(self.currentView==="hours")self.toggleView("minutes",duration/2);else if(self.currentView!="hours"&&options.autoclose){self.minutesView.addClass("clockpicker-dial-out");setTimeout(function(){self.done()},duration/2);self.currentHours=0}plate.prepend(canvas);clearTimeout(movingTimer);self.popover.removeClass("clockpicker-moving");$doc.off(mousemoveEvent)});self.disableOutOfRangeElements()}if(svgSupported){var canvas=popover.find(".clockpicker-canvas"),svg=createSvgElement("svg");svg.setAttribute("class","clockpicker-svg");svg.setAttribute("width",diameter);svg.setAttribute("height",diameter);var g=createSvgElement("g");g.setAttribute("transform","translate("+dialRadius+","+dialRadius+")");var bearing=createSvgElement("circle");bearing.setAttribute("class","clockpicker-canvas-bearing");bearing.setAttribute("cx",0);bearing.setAttribute("cy",0);bearing.setAttribute("r",2);var hand=createSvgElement("line");hand.setAttribute("x1",0);hand.setAttribute("y1",0);var bg=createSvgElement("circle");bg.setAttribute("class","clockpicker-canvas-bg");bg.setAttribute("r",tickRadius);var fg=createSvgElement("circle");fg.setAttribute("class","clockpicker-canvas-fg");fg.setAttribute("r",5);g.appendChild(hand);g.appendChild(bg);g.appendChild(fg);g.appendChild(bearing);svg.appendChild(g);canvas.append(svg);this.hand=hand;this.bg=bg;this.fg=fg;this.bearing=bearing;this.g=g;this.canvas=canvas}raiseCallback(this.options.init)}function raiseCallback(callbackFunction){if(callbackFunction&&typeof callbackFunction==="function")callbackFunction()}ClockPicker.DEFAULTS={default:"",fromnow:0,donetext:"Done",cleartext:"Clear",autoclose:false,ampmclickable:false,darktheme:false,twelvehour:false,vibrate:true,hourstep:1,minutestep:1,ampmSubmit:false,container:"body"};ClockPicker.prototype.toggle=function(){this[this.isShown?"hide":"show"]()};ClockPicker.prototype.locate=function(){var element=this.element,popover=$(this.options.container).append(this.popover),offset=element.offset(),width=element.outerWidth(),height=element.outerHeight(),align=this.options.align,self=this;this.popover.show()};ClockPicker.prototype.parseInputValue=function(){var value=this.input.prop("value")||this.options["default"]||"";if(value==="now"){value=new Date(+new Date+this.options.fromnow)}if(value instanceof Date){value=value.getHours()+":"+value.getMinutes()}value=value.split(":");this.hours=+value[0]||0;this.minutes=+(value[1]+"").replace(/\D/g,"")||0;this.hours=Math.round(this.hours/this.options.hourstep)*this.options.hourstep;this.minutes=Math.round(this.minutes/this.options.minutestep)*this.options.minutestep;if(this.options.twelvehour){var period=(value[1]+"").replace(/\d+/g,"").toLowerCase();this.amOrPm=this.hours>12||period==="pm"?"PM":"AM"}};ClockPicker.prototype.show=function(e){if(this.isShown){return}raiseCallback(this.options.beforeShow);$(":input").each(function(){$(this).attr("tabindex",-1)});var self=this;this.input.blur();this.popover.addClass("picker--opened");this.input.addClass("picker__input picker__input--active");$(document.body).css("overflow","hidden");if(!this.isAppended){this.popover.insertAfter(this.input);if(this.options.twelvehour){this.amOrPm="AM";if(!this.options.ampmclickable){this.amPmBlock.children(".pm-button").removeClass("active");this.amPmBlock.children(".am-button").addClass("active");this.spanAmPm.empty().append("PM")}else{this.spanAmPm.children("#click-am").addClass("text-primary");this.spanAmPm.children("#click-pm").removeClass("text-primary")}}$win.on("resize.clockpicker"+this.id,function(){if(self.isShown){self.locate()}});this.isAppended=true}this.parseInputValue();if(this.hours===0){this.hours=this.minHours}this.spanHours.html(leadingZero(this.hours));this.spanMinutes.html(leadingZero(this.minutes));if(this.options.twelvehour){this.spanAmPm.empty().append(this.amOrPm)}this.disableOutOfRangeElements();this.toggleView("hours");this.locate();this.isShown=true;$doc.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,debounce(function(e){var target=$(e.target);if(target.closest(self.popover.find(".picker__wrap")).length===0&&target.closest(self.input).length===0)self.hide()},100));$doc.on("keyup.clockpicker."+this.id,debounce(function(e){if(e.keyCode===27)self.hide()},100));raiseCallback(this.options.afterShow)};ClockPicker.prototype.hide=function(){raiseCallback(this.options.beforeHide);this.input.removeClass("picker__input picker__input--active");this.popover.removeClass("picker--opened");$(document.body).css("overflow","visible");this.isShown=false;$(":input").each(function(index){$(this).attr("tabindex",index+1)});$doc.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id);$doc.off("keyup.clockpicker."+this.id);this.popover.hide();raiseCallback(this.options.afterHide)};ClockPicker.prototype.disableOutOfRangeElements=function(){let{hours,minutes,currentView,isTwelvehour,amOrPm,maxHours,minHours,maxMinutes,minMinutes}=this;const $hoursTick=$(".clockpicker-hours").children(),$minutesTick=$(".clockpicker-minutes").children(),$amBtn=$(".am-button"),$pmBtn=$(".pm-button"),$doneBtn=$(".done-button");if(isTwelvehour&&currentView==="minutes"){$doneBtn.removeClass("grey-text disabled");if(amOrPm==="AM"&&!(hours+12<=maxHours))$pmBtn.addClass("disabled");else if(amOrPm==="PM"&&!(hours>=minHours))$amBtn.addClass("disabled")}if(isTwelvehour&&amOrPm==="PM"){if(minHours<12)minHours=0;if(minHours>12)minHours-=12;if(maxHours>12)maxHours-=12}if(isTwelvehour&&currentView==="hours"){$amBtn.removeClass("disabled");$pmBtn.removeClass("disabled");if(amOrPm==="AM"&&(!(hours>=minHours)||!(hours<=maxHours))){$doneBtn.addClass("grey-text disabled")}else if(amOrPm==="PM"&&(!(hours>=minHours)||!(hours<=maxHours))){$doneBtn.addClass("grey-text disabled")}else{$doneBtn.removeClass("grey-text disabled")}}if(currentView==="minutes"){if(hours===minHours&&minutes<minMinutes||hours===maxHours&&minutes>maxMinutes)$doneBtn.addClass("grey-text disabled");else $doneBtn.removeClass("grey-text disabled")}if(currentView==="hours"){$hoursTick.each((index,el)=>{let hours=el.innerHTML;if(this.isTwelvehour&&hours==12)hours=0;if(hours>maxHours||hours<minHours)$(el).addClass("grey-text disabled");else $(el).removeClass("grey-text disabled")})}if(currentView==="minutes"){$minutesTick.each((index,el)=>{if(minHours==hours&&el.innerHTML<minMinutes)$(el).addClass("grey-text disabled");else if(maxHours==hours&&el.innerHTML>maxMinutes)$(el).addClass("grey-text disabled");else $(el).removeClass("grey-text disabled")})}};ClockPicker.prototype.toggleView=function(view,delay){var raiseAfterHourSelect=false;if(view==="minutes"&&$(this.hoursView).css("visibility")==="visible"){raiseCallback(this.options.beforeHourSelect);raiseAfterHourSelect=true}var isHours=view==="hours",nextView=isHours?this.hoursView:this.minutesView,hideView=isHours?this.minutesView:this.hoursView;this.currentView=view;this.spanHours.toggleClass("text-primary",isHours);this.spanMinutes.toggleClass("text-primary",!isHours);hideView.addClass("clockpicker-dial-out");nextView.css("visibility","visible").removeClass("clockpicker-dial-out");this.resetClock(delay);clearTimeout(this.toggleViewTimer);this.toggleViewTimer=setTimeout(function(){hideView.css("visibility","hidden")},duration);this.disableOutOfRangeElements();if(raiseAfterHourSelect)raiseCallback(this.options.afterHourSelect)};ClockPicker.prototype.resetClock=function(delay){var view=this.currentView,value=this[view],isHours=view==="hours",unit=Math.PI/(isHours?6:30),radian=value*unit,radius=isHours&&value>0&&value<13?innerRadius:outerRadius,x=Math.sin(radian)*radius,y=-Math.cos(radian)*radius,self=this;if(svgSupported&&delay){self.canvas.addClass("clockpicker-canvas-out");setTimeout(function(){self.canvas.removeClass("clockpicker-canvas-out");self.setHand(x,y)},delay)}else this.setHand(x,y)};ClockPicker.prototype.setHand=function(x,y,roundBy5,dragging){var radian=Math.atan2(x,-y),isHours=this.currentView==="hours",z=Math.sqrt(x*x+y*y),options=this.options,inner=isHours&&z<(outerRadius+innerRadius)/2,radius=inner?innerRadius:outerRadius,unit,value;if(isHours){unit=options.hourstep/6*Math.PI}else{unit=options.minutestep/30*Math.PI}if(options.twelvehour)radius=outerRadius;if(radian<0)radian=Math.PI*2+radian;value=Math.round(radian/unit);radian=value*unit;if(isHours){value*=options.hourstep;if(!options.twelvehour&&!inner==value>0){value+=12}if(options.twelvehour&&value===0){value=12}if(value===24){value=0}}else{value*=options.minutestep;if(value===60){value=0}}let{minHours,maxHours,minMinutes,maxMinutes,amOrPm}=this;if(isHours){let hours=value;if(this.amOrPm==="PM"){if(minHours<12)minHours=0;if(minHours>12)minHours-=12;if(maxHours>12)maxHours-=12}if(this.isTwelvehour&&hours==12)hours=0;if(hours<minHours||hours>maxHours){this.isInvalidTimeScope=true;return}if(this.isTwelvehour&&hours===12){this.isInvalidTimeScope=true;return}}else{let{hours}=this;if(amOrPm==="PM")hours+=12;if(hours==minHours&&value<minMinutes||hours==maxHours&&value>maxMinutes){this.isInvalidTimeScope=true;return}}if(isHours)this.fg.setAttribute("class","clockpicker-canvas-fg");else{if(value%5==0)this.fg.setAttribute("class","clockpicker-canvas-fg");else this.fg.setAttribute("class","clockpicker-canvas-fg active")}if(this[this.currentView]!==value)if(vibrate&&this.options.vibrate)if(!this.vibrateTimer){navigator[vibrate](10);this.vibrateTimer=setTimeout($.proxy(function(){this.vibrateTimer=null},this),100)}this[this.currentView]=value;this[isHours?"spanHours":"spanMinutes"].html(leadingZero(value));if(!svgSupported){this[isHours?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var tick=$(this);tick.toggleClass("active",value===+tick.html())});return}if(dragging||!isHours&&value%5){this.g.insertBefore(this.hand,this.bearing);this.g.insertBefore(this.bg,this.fg);this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")}else{this.g.insertBefore(this.hand,this.bg);this.g.insertBefore(this.fg,this.bg);this.bg.setAttribute("class","clockpicker-canvas-bg")}var cx=Math.sin(radian)*radius,cy=-Math.cos(radian)*radius;this.hand.setAttribute("x2",cx);this.hand.setAttribute("y2",cy);this.bg.setAttribute("cx",cx);this.bg.setAttribute("cy",cy);this.fg.setAttribute("cx",cx);this.fg.setAttribute("cy",cy)};ClockPicker.prototype.clearInput=function(){this.input.val("");this.hide();if(this.options.afterDone&&typeof this.options.afterDone==="function")this.options.afterDone(this.input,null)};ClockPicker.prototype.getTime=function(callback){this.parseInputValue();var hours=this.hours;if(this.options.twelvehour&&hours<12&&this.amOrPm==="PM"){hours+=12}var selectedTime=new Date;selectedTime.setMinutes(this.minutes);selectedTime.setHours(hours);selectedTime.setSeconds(0);return callback&&callback.apply(this.element,selectedTime)||selectedTime};ClockPicker.prototype.done=function(){raiseCallback(this.options.beforeDone);this.hide();this.label.addClass("active");var last=this.input.prop("value"),outHours=this.hours,value=":"+leadingZero(this.minutes);if(this.isHTML5&&this.options.twelvehour){if(this.hours<12&&this.amOrPm==="PM"){outHours+=12}if(this.hours===12&&this.amOrPm==="AM"){outHours=0}}value=leadingZero(outHours)+value;if(!this.isHTML5&&this.options.twelvehour){value=value+this.amOrPm}this.input.prop("value",value);if(value!==last){this.input.trigger("change");if(!this.isInput)this.element.trigger("change")}if(this.options.autoclose)this.input.trigger("blur");raiseCallback(this.options.afterDone)};ClockPicker.prototype.remove=function(){this.element.removeData("clockpicker");this.input.off("focus.clockpicker click.clockpicker");if(this.isShown)this.hide();if(this.isAppended){$win.off("resize.clockpicker"+this.id);this.popover.remove()}};$.fn.pickatime=function(option){var args=Array.prototype.slice.call(arguments,1);function handleClockPickerRequest(){var $this=$(this),data=$this.data("clockpicker");if(!data){var options=$.extend({},ClockPicker.DEFAULTS,$this.data(),typeof option=="object"&&option);$this.data("clockpicker",new ClockPicker($this,options))}else{if(typeof data[option]==="function")data[option].apply(data,args)}}if(this.length==1){var returnValue=handleClockPickerRequest.apply(this[0]);return returnValue!==undefined?returnValue:this}return this.each(handleClockPickerRequest)};$(".time-picker-opener").on("click",e=>{e.stopPropagation();e.preventDefault();const openElementData=e.target.dataset.open;const $picker=$(`#${openElementData}`).pickatime("picker");$picker.data("clockpicker").show()})})();